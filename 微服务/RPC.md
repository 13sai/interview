## RPC 是什么？

RPC（Remote Procedure Call Protocol）——**远程过程调用协议**，它是一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的协议。RPC协议假定某些传输协议的存在，如TCP或UDP，为通信程序之间携带信息数据。在OSI网络通信模型中，RPC跨越了传输层和应用层。RPC使得开发包括网络分布式多程序在内的应用程序更加容易。

RPC采用**客户机/服务器**模式。请求程序就是一个客户机，而服务提供程序就是一个服务器。首先，客户机调用进程发送一个有进程参数的调用信息到服务进程，然后等待应答信息。在服务器端，进程保持睡眠状态直到调用信息到达为止。当一个调用信息到达，服务器获得进程参数，计算结果，发送答复信息，然后等待下一个调用信息，最后，客户端调用进程接收答复信息，获得进程结果，然后调用执行继续进行。

![RPC框架](https://static001.geekbang.org/resource/image/ac/fa/acf53138659f4982bbef02acdd30f1fa.jpg)

**RPC的作用就是体现在这样两个方面：**

- 屏蔽远程调用跟本地调用的区别，让我们感觉就是调用项目内的方法；
- 隐藏底层网络通信的复杂性，让我们更专注于业务逻辑。



## RPC VS  HTTP

对于大型企业来说，内部子系统较多、接口非常多的情况下，`RPC` 框架的好处就显示出来了，首先就是长链接，不必每次通信都要像 `http` 一样去 3 次握手什么的，减少了网络开销；其次就是 `RPC` 框架一般都有注册中心，有丰富的监控管理；发布、下线接口、动态扩展等，对调用方来说是无感知、统一化的操作。

RPC适合用于公司内部的服务调用，性能消耗低，传输效率高，服务治理方便。HTTP主要用于对外的异构环境，浏览器接口调用，APP接口调用，第三方接口调用等。

#### 1. 传输协议

RPC，可以基于TCP协议（传输层），也可以基于HTTP协议

HTTP，基于HTTP协议（应用层）

#### 2. 传输效率

RPC，可使用自定义的 `TCP` 协议，可以让请求报文体积更小，或者使用 `HTTP2` 协议，也可以很好的减少报文的体积， 提高传输效率

HTTP，如果是基于HTTP1.1的协议，请求中会包含很多无用的内容，如果是基于`HTTP2.0`，那么简单的封装以下是可以作为一个 `RPC` 来使用的，这时标准 `RPC` 框架更多的是服务治理

#### 3. 性能消耗

RPC，可以基于thrift实现高效的二进制传输，主要在于序列化和反序列化的耗时

HTTP，大部分是通过json来实现的，字节大小和序列化耗时都比thrift要更消耗性能

#### 4. 负载均衡

RPC，基本都自带了负载均衡策略 

HTTP，需要配置Nginx，HAProxy来实现

#### 5.服务治理

RPC，能做到自动通知，不影响上游 

HTTP，需要事先通知，修改Nginx/HAProxy配置



[GRpc的简单使用](https://zhuanlan.zhihu.com/p/331744221)